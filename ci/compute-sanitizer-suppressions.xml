<?xml version="1.0" encoding="utf-8"?>
<ComputeSanitizerOutput>
  <record>
    <kind>Initcheck</kind>
    <what>
      <text>Uninitialized __global__ memory read of size 4 bytes</text>
      <size>4</size>
    </what>
    <where>
      <func>.*</func>
    </where>
    <hostStack>
      <frame>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <func>cusparseCsr2cscEx2</func>
        <module>.*libcusparse.so.*</module>
      </frame>
    </hostStack>
  </record>
  <record>
    <kind>Initcheck</kind>
    <what>
      <text>Uninitialized __global__ memory read of size 4 bytes</text>
      <size>4</size>
    </what>
    <where>
      <func>ThreadLoad</func>
    </where>
    <hostStack>
      <frame>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <module>libcudart.*</module>
      </frame>
      <frame>
        <func>cudaLaunchKernel</func>
      </frame>
      <frame>
        <func>.*cub::.*::Device(Segmented)?(Reduce|Scan)(SingleTile)?Kernel.*</func>
      </frame>
    </hostStack>
  </record>
  <record>
    <kind>Initcheck</kind>
    <what>
      <text>Uninitialized __global__ memory read of size 2 bytes</text>
      <size>2</size>
    </what>
    <where>
      <func>ThreadLoad</func>
    </where>
    <hostStack>
      <frame>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <module>libcudart.*</module>
      </frame>
      <frame>
        <func>cudaLaunchKernel</func>
      </frame>
      <frame>
        <func>.*cub::.*::Device(Segmented)?(Reduce|Scan)(SingleTile)?Kernel.*</func>
      </frame>
    </hostStack>
  </record>
  <record>
    <kind>Initcheck</kind>
    <what>
      <text>Uninitialized __global__ memory read of size 8 bytes</text>
      <size>8</size>
    </what>
    <where>
      <func>DeviceSegmentedReduceKernel</func>
    </where>
  </record>
  <record>
    <kind>Initcheck</kind>
    <what>
      <text>Uninitialized __global__ memory read of size 4 bytes</text>
      <size>4</size>
    </what>
    <where>
      <func>ThreadLoad</func>
    </where>
    <hostStack>
      <frame>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <module>libcudart.*</module>
      </frame>
      <frame>
        <module>libcudart.*</module>
      </frame>
      <frame>
        <module>.*libcuopt.*</module>
      </frame>
      <frame>
        <func>.*Device(Reduce|Scan)Kernel.*</func>
      </frame>
    </hostStack>
  </record>
  <!-- Rule matching cccl's pattern of copying tuples back to host after reduce_by_keys, which contain uninitialized padding  -->
  <!-- Because of aggressive inlining, thrust calls are elided out of the host stack, which prevents a more finely grained rule. In practice this is good enough -->
  <record>
    <kind>InitcheckApiError</kind>
    <level>Error</level>
    <what>
      <text>Host API uninitialized memory access</text>
      <accessSize>16</accessSize>
    </what>
    <hostStack>
      <frame>
        <func>cuMemcpyDtoHAsync.*</func>
        <module>.*libcuda.so.*</module>
      </frame>
    </hostStack>
  </record>
  <!-- Suppress uninit copies on rmm::device_vector copy constructor - often vector members are allocated but not filled -->
  <record>
    <kind>InitcheckApiError</kind>
    <level>Error</level>
    <what>
      <text>Host API uninitialized memory access</text>
    </what>
    <hostStack>
      <frame>
        <func>cuMemcpyAsync</func>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*librmm.so.*</module>
      </frame>
      <frame>
        <func>rmm::device_buffer::device_buffer</func>
        <module>.*librmm.so.*</module>
      </frame>
    </hostStack>
  </record>
  <record>
    <kind>InitcheckApiError</kind>
    <level>Error</level>
    <what>
      <text>Host API uninitialized memory access</text>
    </what>
    <hostStack>
      <frame>
        <func>cuMemcpyAsync</func>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*librmm.so.*</module>
      </frame>
      <frame>
        <module>.*librmm.so.*</module>
      </frame>
      <frame>
        <func>rmm::device_uvector.*::device_uvector</func>
        <module>.*libcuopt.so.*</module>
      </frame>
    </hostStack>
  </record>
  <!-- Uninitialized device-to-device copies are usually harmless - if actualy bogus, errors may be caught later on -->
  <record>
    <kind>InitcheckApiError</kind>
    <level>Error</level>
    <what>
      <text>Host API uninitialized memory access</text>
    </what>
    <hostStack>
      <frame>
        <func>cuMemcpyDtoDAsync.*</func>
        <module>.*libcuda.so.*</module>
      </frame>
    </hostStack>
  </record>
  <record>
    <kind>InitcheckApiError</kind>
    <level>Error</level>
    <what>
      <text>Host API uninitialized memory access</text>
    </what>
    <hostStack>
      <frame>
        <func>cuMemcpyAsync</func>
        <module>.*libcuda.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <module>.*libcudart.so.*</module>
      </frame>
      <frame>
        <func>cudaMemcpyAsync</func>
      </frame>
      <frame>
        <func>rmm::device_buffer::resize</func>
        <module>.*librmm.so.*</module>
      </frame>
    </hostStack>
  </record>
</ComputeSanitizerOutput>
